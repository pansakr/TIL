### AWS(Amazon Web Services)

* 아마존에서 제공하는 클라우드 서비스

    - 아마존 이라는 회사는 온라인 쇼핑몰을 운영하는데, 사용자가 폭증하는 블랙 프라이데이 같은 세일 기간에 쇼핑몰을 정상적으로 운영하기 위해 서버를 증설함

    - 세일기간이 끝난 후 사용자 수가 원래대로 돌아가면서 증설한 서버들이 필요 없어지게 됨

    - 평소 5개의 서버로 서비스가 가능한데, 사용자가 폭증하는 잠깐을 위해 서버를 20개로 늘렸다가 다시 5개로 서비스가 가능해진 상황

    - 아마존은 다른 회사들에게 남는 컴퓨터들을 대여해주었고, 이를 클라우드 서비스라 하며 aws 의 시작이 되었다

* 클라우드 서비스

    - 클라우드
    
        - 인터넷을 통해 가상화된 IT 자원(서버, 저장소 등)을 대여해주는 시스템/모델

    - 클라우드 서비스
    
        - 클라우드 개념을 기반으로 실제로 자원을 제공해주는 서비스/상품 (AWS 등)

        - 일반 서버

            - 직접 서버를 구매해서 설치하고 운영

            - 초기비용과 시간이 많이 걸림

        - 클라우드

            - 이미 구축된 서버와 자원을 필요한 만큼 빌려서 사용

            - 초기비용이 적게 들고 빠르게 시작할 수 있음

            - 보안, 장애복구 등 부가 기능도 포함

    - 클라우드 서비스 종류

        - laaS(Infrastructure as a Service)

            - 가상 서버, 스토리지 같은 기반 자원만 제공 (AWS EC2)

            - 서버 설정, 운영 환경(OS, 애플리케이션 서버, 빌드 도구 등) 설정 직접 해야 함

            - 가상 서버

                - 물리 서버 1대를 가상화 기술을 사용해 여러 개로 나눠 만든 서버

                    - ex) VMware 로 하나의 호스트 컴퓨터에 여러 가상 서버를 생성 가능

                - 가상 서버들은 물리 서버(호스트 서버) 자원의 일부를 사용한다
                    
                - AWS 는 하나의 물리 서버에 가상화 소프트웨어를 설치해서 CPU, 메모리 등의 자원을 나눠서 사용하는 여러 개의 가상 서버를 생성한다

                - 즉 AWS의 가상 서버 대여 시(EC2 인스턴스 생성) AWS는 자신들의 물리 서버 중 일부를 할당해 하나의 가상 머신을 만들어 준다

                - 가상 서버 대여 시 기본 스토리지가 함께 제공되며, 필요시 스토리지를 추가로 대여해서 저장 공간을 더 확보할 수 있다

            - 스토리지
            
                - 데이터를 저장하고 보관하는 장치나 시스템 (HDD, SSD 등)

                - AWS 에서 스토리지는 HDD나 SSD를 기반으로 구축된 저장 시스템을 사용자가 인터넷을 통해 가상으로 빌려 쓰는 것

                - VMware 에서 HDD나 SSD 의 용량을 설정하면 그것은 결국 내 컴퓨터의 자원의 일부분을 사용하는 것처럼, AWS 의 스토리지 대여 시 AWS 쪽에 있는 인프라의 일부를 빌려 쓰는 것

        - PaaS(Platform as a Service)

            - 서버 + 운영환경을 자동 구성해서 제공해줌 (AWS Elastic Beanstalk)

            - 하지만 지원하는 언어와 버전, 프레임워크 등이 제한되어 있고 정해진 방식으로만 동작하며 사용량에 비해 비싸다

        - SaaS(Software as a Service)

            - 완성된 소프트웨어 제공 (Gmail, Google Docs, Notion)

            - 완성된 소프트웨어를 빌려서 사용하는 서비스로 개발자보단 일반 사용자, 관리자 등을 위한 서비스

* 계정 종류

    - 루트 계정

        - 계정의 주인으로 모든 권한을 가지고 있으며, Email 과 비밀번호로 로그인한다

        - IAM 서비스를 사용해 IAM 사용자를 생성할 수 있다

    - IAM(Identity and Access Management) 계정

        - 루트 계정이 IAM 서비스로 권한을 부여해 생성한 계정

            - IAM : AWS 자원에 대한 접근을 안전하게 제어할 수 있는 웹 서비스

        - 루트 계정은 모든 권한을 가지고 있기 때문에 공유가 금지되어야 하고, 보안에도 주의해야 한다

        - 때문에 루트 계정 대신 특정 권한만을 가진 IAM 계정을 여러개 생성해 팀원들에게 나눠줄 수도 있고, 실수나 보안에도 더 유의할 수 있다

* 용어

    - 리전 

        - 서버의 위치

        - 클라우드 서비스 제공업체가 전 세계에 분산시켜 놓은 데이터 센터(서버)

    - EC2(Elastic Compute Cloud)

        - AWS에서 제공하는 가상 서버 서비스

        - Elastic : 탄력있는, Compute Cloud : 클라우드에서 컴퓨팅 자원(CPU, 메모리 등) 을 빌려 쓰는 서비스

    - AWS 의 EC2 에서의 인스턴스(객체)

        - EC2 서비스에서 실행 중인 가상 서버 한 대

        - 인스턴스 시작 : 가상 서버 부팅

        - 인스턴스 : 추상화된 정의를 실제로 만든 것

### AWS 서버 임대 방법

* 로그인 후 우측 상단의 리전을 아시아 태평양(서울) 로 변경

* 왼쪽 상단의 검색창에 EC2 검색 -> 인스턴스 시작

* 이름 및 태그

    - 사용할 서버 이름 입력 - ex) test-web .. 

    - 태그 : EC2 인스턴스를 구분하고 관리하기 쉽게 하기 위해 붙이는 이름표

    - 태그는 key:value 형식으로 관리됨

    - 화면의 이름 및 태그 란의 빈칸에 입력한 서버 이름은 내부적으로 value로 저장되고, 첫 태그 이므로 Name 이라는 키가 자동으로 붙음

        - 첫 태그만 예외적으로 NAME 이라는 Key가 자동으로 붙음

        - 이후 태그부터는 Name, Key 모두 지정해 줘야 함

* 애플리케이션 OS 이미지(Amazon Machine Image)

    - EC2 인스턴스에서 사용할 OS 선택

    - OS의 버전을 고를 수 있으며, AWS 계정 등급에(과금 정도) 따라 선택할 수 있는 OS 버전도 있음

    - 예시 : Ubuntu Server 24.04 LTS (HVM), SSD Volume Type

        - Ubuntu Server 24.04 LTS : Ubuntu의 2024년 4월 LTS(Long Term Support) 버전

        - LTS(Long Term Support) : 5년간 보안/패치 지원되는 안정 버전

        - HVM : 가상화 방식

        - SSD Volume Type : EC2 인스턴스의 루트 디스크가 SSD 기반 EBS 볼륨(빠름)

* 인스턴스 유형

    - 서버의 스펙 선택

    - 가상 서버의 사양(CPU, 메모리, 네트워크 성능 등)을 정해놓은 템플릿

    - 패밀리와(t3, m5, c5..) 사이즈로(micro, small ..) 으로 이루어져 있다

        - 패밀리

            - t : 저비용, 범용, 버스트 성능

                - 평소에는 cpu 성능이 낮게 제한되어있고, 필요할 때 버스트(잠깐 강하게) 할 수 있음

                - 버스트로 계속 쓰면 cpu 성능이 다시 낮아짐 

                - 비용이 저렴하며 개발 및 테스트 서버, 소규모 웹 서버에 적합

            - m : 범용, cpu/메모리 균형

                - cpu 성능이 일정함

                - t 보다 비싸며 운영 환경에 적합

            - c : CPU 성능 중심

                - 무거운 계산 작업에 적합 (빌드, 분석 등)

            - r : 메모리 중심, 캐시 서버나 인메모리 DB에 적합

            - g : GPU 탑재, 머신러닝/3D 작업용

        - 사이즈 (스펙 수준)

            - micro -> small -> medium, large -> xlarge -> 2xlarge

* 키 페어

    - SSH 로그인 설정

    - EC2 인스턴스(서버)에 안전하게 접속하기 위한 비밀번호 대신 쓰는 보안 키

    - 공개키와 개인키 한쌍으로 구성되며 이를 이용해 SSH 로그인 인증을 한다

    - 키 페어 생성 -> 키 페어 이름 입력 
    
    - 키 페어 유형 : RSA, 프라이빗 키 파일 형식 : .pem

    - .pem 파일이 접속 열쇠이며, 분실 시 해당 인스턴스에 다시 접속 불가능하므로 백업이 필수이다

* 네트워크 설정

    <img src = "https://raw.githubusercontent.com/pansakr/TIL/refs/heads/main/%EC%9D%B4%EB%AF%B8%EC%A7%80/Aws/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%20%EC%84%A4%EC%A0%95.JPG" alt = "네트워크 설정">

    - EC2 인스턴스에 어떤 트래픽(포트, 프로토콜, IP 대역)을 허용할지 설정

    - 퍼블릭 IP 자동할당 활성화

        - EC2 인스턴스 생성 시 공개 IP 자동할당

        - 공개 IP
        
            - 외부에서 접속이 가능하지만, 인스턴스 중지/재시작 시 IP가 바뀜

            - IP가 바뀌면 도메인 연결도 끊어지므로 테스트 용도 서버에 적합

        - 공개 고정 IP

            - 외부에서 접속 가능하며, 인스턴스 중지/재시작 시 IP가 고정

            - 웹 서버를 운영하려면 반드시 공개 고정 IP 사용해야 함

            - EC2 에선 탄력적 IP (Elastic IP) 할당으로 공개 고정 IP를 인스턴스에 할당할 수 있다

            - 발급 방법

                - AWS의 EC2 대시보드 -> 왼쪽 메뉴의 탄력적 IP 주소 

                - 오른쪽 상단의 탄력적 IP 주소 할당 -> 범위 : Amazon의 IPv4 주소 풀 -> 할당 -> 발급완료

                - 새로 발급된 IP 선택 -> 오른쪽 상단의 탄력적 IP 주소 연결

                - 리소스 : 인스턴스, 인스턴스 : 연결할 EC2 인스턴스, 프라이빗 IP 주소 : 연결할 EC2 인스턴스의 프라이빗 IP주소

                - 완료


    - 보안 그룹 : 인스턴스에 대한 방화벽 역할을 할 규칙

        - 다음에서 SSH 트래픽 허용 : 22 포트 허용

        - 인터넷에서 HTTPS 트래픽 허용 : 443 포트를 허용해서 외부에서 https로 접근할 수 있게 함

            - HTTPS : 웹 보안 통신이며 443 포트를 사용

        - 인터넷에서 HTTP 트래픽 허용 : 80 포트를 허용해서 외부에서 https로 접근할 수 있게 함

        - 위치 무관 (0.0.0.0/0) : 전 세계 모든 IP 에서 이 인스턴스로 접속을 허용

* 스토리지 구성

    - EC2 인스턴스에서 사용할 하드 디스크 설정

        - 인스턴스 유형에서 나온 저장 장치는 메모리 이다

    - 1 x 30 GiB gp3 선택

    - 1 x 30 GiB : 디스크 볼륨 1개, 크기는 30Gb

    - gp3 : 디스크 종류(General Purpose SSD v3 – 빠르고 일반적인 용도) 

    - 루트 볼륨 : EC2 인스턴스의 기본 디스크(운영체제가 설치되는 곳)

    - 3000 IOPS : 입출력 속도 기준

    - 암호화되지 않음 : 디스크 내용이 암호화되어 저장되지 않음 (보안이 중요한 경우 암호화 가능)
