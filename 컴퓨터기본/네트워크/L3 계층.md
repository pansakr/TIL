### IPv4

* IP란 인터넷이 통하는 네트워크에서 어떤 정보를 수신하고 송신하는 통신에 대한 규약이다.

* private ip, public ip 로 나뉘며 private ip는 네트워크 안에서 사용되며 네트워크 안에서만 유일하며 다른 네트워크의 ip와 중복될 수 있다.

* public ip는 전 세계에서 공인된 유일한 주소이며 외부와 통신할 때 공유기와 같은 기기에서 public ip로 변경된다.

* 즉 ip주소로 알 수 있는 것은 목적지 컴퓨터 주소가 아닌 컴퓨터가 위치한 인터넷 네트워크이다.

* IP주소는 Internet Protocol을 쓰는 인터넷 망에서 인터넷에 연결된 컴퓨터를 식별하기 위해서 부여하는 고유번호이다.

* 그중 IPv4는 32비트 주소체계다. 8비트씩 나눠 4칸이 나오고 한칸을 옥텟이라고 한다.

* 컴퓨터끼리 통신을 할때 통신 대상의 ip주소를 반드시 알고 있어야 한다.

* 보통 컴퓨터와 서버가 통신을 하는데 서버의 도메인 네임과 ip주소는 dns서버가 가지고있고 도메인 네임을 통해 통신 시도시 해당하는 ip주소를 알려준다. 

```
// IPv4는 32비트 주소체계이고 32비트는 8비트가 4번 있다는 것과도 같다.
// IPv4는 .을 경계로 4칸으로 나누고 각 칸마다 0 ~ 255의 8비트 범위의 숫자 들어간다.
// 첫번째부터 3개의 칸 24비트로 네트워크 아이디를 나타내고, 마지막 한칸인 8비트로 호스트 아이디를 나타낸다.
// ip주소 예시 - 192.168.0.10 
// 192.168.0 이 네트워크 아이디, 10이 호스트 아이디이다.
// 192는 2진수로 1100 0000, 168은 1010 1000이고 이처럼 8비트 이진수롤 십진수로 변환해 표현한다. 
```

* 용도에 따라 A class, B class , C class 로 나뉜다. D, E 클래스는 특수한 목적으로 사용되는 클래스로 실제 ip 주소가 할당되지 않는다. 

* 아이피 주소의 첫번째 옥텟이 0 ~ 127이면 A클래스이고 , 128 ~ 191이면 B, 192 ~ 223이면 C이다.

* A클래스는 IP의 첫번째 옥텟이 네트워크 ID이고 나머지 2,3,4 옥텟이 호스트 ID이다. 호스트 수가 제일 많이 나온다.

* B클래스는 IP의 첫번째, 두번째 옥텟이 네트워크 ID이고 나머지 3,4 옥텟이 호스트 ID이다.

* C클래스는 IP의 첫번째, 두번째, 세번째  옥텟이 네트워크 ID이고 나머지 4 옥텟이 호스트 ID이다. 호스트 수가 제일 적게 나온다.

* 즉 호스트가 많은 곳은 A, 반대는 C 로 분배하는 것이고 한정된 IP주소를 효율적으로 사용하는것에 목적이 있다.

```
// A클래스를 사용한 IP주소는 약 1670만개의 호스트를 가질수 있는데 이것을 60개의 호스트가 있는 네트워크에 준다면 엄청난 낭비이다.

// C클래스를 사용한 IP주소는 254개의 호스트를 가질 수 있지만 100만개의 호스트가 있는 네트워크를 C클래스로 분배해준다면 254 * ? = 100만 ?개의 네트워크 주소가 필요할 것이다. 

//A클래스 주소를 준다면 1개로 충분한 것을 엄청난 낭비가 발생한 것이고 이런 식으로 분배해준다면 IP주소는 금방 고갈될 것이다.

// IP주소는 한정된 자원으로 최대한 효율적으로 분배해야 하고 그렇게 하기 위해 서브넷 마스크가 나왔다.
```

* 네트워크 ID가 같다면 같은 네트워크게 속해있다는 것이고, 호스트 ID는 그 네트워크에 속한 사용자에게 부여하는 번호이다.


### Host 자신을 가리키는 Ip 주소

* 127.0.0.1

* 이 주소로 pc내부의 프로세스들이 통신한다.


### 브로드 캐스트 주소

* 특정 네트워크 영역에 속하는 모든 호스트들에게 정보를 전달 가능한 주소

* 하나의 네트워크 영역에서 맨 뒤의 주소


### 브로드캐스트 영역

* 어떤 단말이 브로드캐스트 패킷을 송출할 때 이 패킷에 대해서 네트워크에서 영향을 받는 영역


### DHCP(Dynamic Host Configuration Protocol) 서버

* 브로드캐스트 영역 내에서 인터넷설정에 필요한 정보(호스트의 ip주소, 서브넷 마스크, 게이트웨이, dns) 를 자동으로 제공해주는 역할을 한다.


### ARP(Address Resolution Protocol)

* IP 주소를 물리적 네트워크 주소로 대응 시키기 위해 사용되는 프로토콜

* 어떤 pc가 서버로 데이터를 보낼때 목적지의 mac주소는 게이트웨이로 잡힌다.

* 게이트웨이는 ip패킷 헤더의 목적지를 보고 보내준다.


### 네트워크 주소

* 하나의 네트워크 영역에서 맨 앞의 주소


### 인터넷

* 라우터(L3 스위치)와 dns의 집합


### 서브넷

* 네트워크를 분할해 나눠진 작은 네트워크

* 낭비되는 IP주소 자원을 최소화하려는 것이 주된 목적

* 네트워크를 분할하는것을 서브네팅이라고 한다.

* 서브넷 마스크를 통해 서브네팅을 수행한다.


### 서브네팅

* A, B, C로 나눠진 IP주소들을 서브넷 마스크를 이용해 더 많은 세부 네트워크 주소로 나눈 것

* IP주소의 낭비를 최소화하기 위해 사용한다. 


### 서브넷 마스크

<img src="https://github.com/pansakr/TIL/assets/118809108/a0cc2219-6b33-4456-a856-bd9262b29e9b">

* 서브넷을 만들때 사용되는 32비트 숫자

* 이 숫자로 ip주소와 and연산을 하여 서브넷을 만든다.


### 소켓

* 커널모드의 프로토콜을 유저모드의 어플리케이션이 접근할 수 있도록 추상화한 인터페이스


### 패킷

* 컴퓨터간 데이터를 주고받을때 L3계층인 네트워크를 통해 전송되는 데이터 단위

* 헤더와 페이로드(Payload)로 나뉜다.

* 헤더에는 출발한 p주소, 목적지 ip주소 등이 담겨있다. 

* MTU(Maxiam Transmission Unit) - 최대 전송 단위 는 1500byte다.


### 패킷의 전달

* 프로세스가 소켓에 데이터를 send한다. 

* Stream의 데이터를 세그먼트나 포켓의 최대 단위에 맞게 자른다.

* 커널모드 L4계층의 tcp가 tcp헤더를 붙이고 페이로드에 data를 담는다.(L4 데이터 단위는 Segment)

* 커널모드 L3계층의 ip가 tcp헤더 앞에 ip헤더를 붙인다.

* 커널모드 L2계층의 이더넷이 Fream헤더를 붙인다.

* 이후 L2스위치 -> L3스위치 -> 인터넷.. 으로 전송된다. 

* 최종적으로 데이터가 목적지에 도착하면 수신 측에서는 port번호로 데이터를 받아줄 컴퓨터 내부의 장치를 찾는다.


### TTL(Time To Live)

* 패킷의 생존 시간

* 패킷 내에 있는 값으로 패킷이 네트워크 내에 너무 오래 있어서 버려져야 하는지 여부를 라우터에게 알려주는 역할을 한다.

* 패킷이 여러 이유로 목적지에 도착하지 못할 경우 네트워크에 남게 되고 이런 목적지를 잃은 패킷들이 쌓이면 네트워크가 다운되기 때문에 ttl을 이용해 폐기시켜준다.
