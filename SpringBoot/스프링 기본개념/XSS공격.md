### xss방어 

* 글작성 화면이 있고 작성완료하면 목록으로 이동하는 게시판이 있다고 가정할때, 글작성화면의 텍스트입력하는곳에

``` 
게시글제목 : ...     <-- 제목 입력하는 빈 공간처럼 텍스트 입력하는곳
```

* 이런 코드를 작성하면 원래 게시판의 의도인 제목이 서버에 들어가는게아니라 자바스크립트 코드가 실행되게 된다.

```
게시글제목 : <script>자바스크립트 코드내용..</script>
```

* 이것을 xss 공격이라 하고 이런 방법으로 단순 alert 창 띄우는 것부터 사용자의 쿠키나 민감한 정보들까지 빼갈 수 있기 때문에 웹사이트는 방어를 해야한다.

* 그 방법은 JSTL의 c:out 태그를 사용하는 것이다. 이것은 데이터를 출력할때 사용하는 것인데

```
<C: OUT VALUE="${데이터}"> // 태그 안의 속성 VALUE에 ${} <--EL 을 집어넣어 출력한다. 
```

* 기존에는 ${데이터}이렇게만 써서 출력함. 

* EL 과 비교하면 데이터를 출력하는 것은 같다. 

* 하지만 EL은 안에 데이터가 무엇이든 그대로 해석해서 출력하는것에 비해 <C: OUT VALUE="${}"> 이렇게 태그를 포함시키면 <,> ,&,' 와 같은 특수문자가 있을경우 해석하지 않고 그대로 출력한다

* 이렇게 들어서는 이게 왜 방어방법인지 의문이 들지만 특수문자를 해석해서 출력하면, 즉 EL만 썼을때는 출력해줘야 할 값에<script>같은 값이 있을경우 문자열로 출력되는게 아니라 자바스크립트 코드가 실행된다. 

* 그렇다는 것은 게시글 값, 즉 문자열이 넘어와야 되는데 코드가 실행되는 xss 공격이 들어오는 것이고,

* EL 대신 c:out 태그를 사용한다면 <script> 값을 출력할때 앞 뒤로 특수문자인 <, > 가 있으니 해석하지 않고, 

* 즉 자바스크립트 문법에 맞다고 실행하지 말고 문자열로 그대로 뽑아주는 것이다.

* 결과로 게시판에 글제목: <script> 이렇게 코드가 실행되는게 아닌 문자열로 출력되는 것이다.

* <C:OUT> 태그로도 EL처럼 출력 할 수 있는데 <C: OUT VALUE="${}" escapeXml=false> c:out 태그에 escapeXml 속성을 추가해주고 false를 지정해주는 것이다 이렇게 하면 el처럼 값을 해석해서 출력한다.

* escapeXml 속성의 기본값은 true이고 이 경우 위에서 설명한 것처럼 문자열을 해석하지 않고 내보낸다.

* 기본값으로 사용할 때는 escapeXml 속성을 명시하지 않아도 된다.
  
### xss공격 실행 시점

* xss 공격이 들어올때 버튼을 눌러 게시글 제목 페이지 완료 버튼을 눌러 서버로 넘어가기 전 에서 실행되는지, 서버들어갔다 나와서 이동한 페이지에서 실행되는지는 잘 모르겠다. 
  
* 그러나 c:out 태그를 사용함으로서 방지한다고 하는걸 보니 이동 후 페이지에서 실행되는거 같다. 추측임.

   
