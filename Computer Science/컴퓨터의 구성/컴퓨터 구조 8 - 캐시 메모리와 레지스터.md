### 캐시 메모리

* cpu의 연산 속도와 메모리 접근 속도의 차이를 줄이기 위한 저장 장치

* 레지스터보다 용량이 크고 메모리보다 빠른 SRAM 기반의 저장 장치

    * 저장 장치 계층 구조

        - 다른 용량과 성능의 저장 장치들을 계층화하여 표현한 구조

        <img src ="https://raw.githubusercontent.com/pansakr/TIL/refs/heads/main/%EC%9D%B4%EB%AF%B8%EC%A7%80/Computer%20Science/%EC%BB%B4%ED%93%A8%ED%84%B0%EC%9D%98%20%EA%B5%AC%EC%84%B1%2C%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/%EC%A0%80%EC%9E%A5%20%EC%9E%A5%EC%B9%98%20%EA%B3%84%EC%B8%B5%20%EA%B5%AC%EC%A1%B0.jpg" alt="저장 장치 계층 구조">

 
        - 보통 빠른 저장 장치는 용량이 작고 비싸며, 느린 저장 장치는 용량이 크고 저렴하다

        - cpu에 가까운 저장 장치일수록 빠르고 용량이 작고 비싸다

* cpu는 프로그램을 실행하며 메모리에 저장된 데이터를 사용하는데, cpu가 메모리에 접근하는 시간은 cpu의 연산 속도보다 느리기 때문에 cpu의 연산 속도가 아무리 빨라도 메모리에 접근하는 시간이 느리면 cpu의 빠른 연산 속도는 쓸모가 없어진다

* 캐시 메모리에 cpu가 필요로 하는 데이터가 있다면 데이터 접근 시간을 줄일 수 있다

   - 이 문제를 해결하기 위해 사용하는 것이 캐시 메모리이다.

   - 캐시 메모리는 CPU가 처리를 하고있을때 메모리로부터 처리에 데이터를 들고와 저장해놓는다.

   - CPU는 데이터를 가지러 메모리에 접근할 피룡 없이 캐시 메모리가 들고온 데이터를 바로 처리한다.

   - 캐시 메모리는 CPU 내부에 있기 때문에 CPU가 바로 접근이 가능하다.

   - CPU는 먼저 캐시에 필요한 데이터가 존재하는지 확인 후 있다면 캐시 데이터를 읽어 처리한다.

* 코어와 가까운 순서대로 L1 ~ L3 캐시 메모리 라고 부르며, L1 캐시 메모리가 용량이 가장 작고 속도가 빠르며 비싸다

* cpu가 메모리 내의 데이터가 필요하다면 우선 L1 캐시를 살펴보고, 없다면 L2, L3순으로 검색한다

* L1, L2 는 코어 내부에 위치해 코어마다 고유한 캐시 메모리로 활용되고, L3는 코어 외부에 위치해 여러 코어가 공유하는 형태로 사용된다


#### 참조 지역성 원리

* cpu가 메모리에 접근할 때, 특정 패턴이 있다는 개념을 설명하는 원리

* 캐시 메모리는 참조 지역성 원리에 따라 cpu가 사용할 대상을 예측해서 저장하며, cpu가 캐시에서 필요한 데이터를 찾을 확률을 Hit rate(적중률)이라고 한다.

    - 예측한 데이터가 들어맞아 캐시 메모리의 데이터가 cpu가 활용될 경우 '캐시 히트' 라 한다

    - 예측이 틀려 cpu가 메모리에서 필요한 데이터를 직접 가져와야 하는 경우 '캐시 미스'라 한다
 
    - 캐시 메모리의 성능은 Hit rate에 의해 결정된다

* 참조 지역성은 크게 두가지로 나눌 수 있다

    - 시간 지역성

        - 최근에 접근했던 메모리 공간에 다시 접근하려는 경향

        - 프로그래밍 언어에서 변수는 여러번 재사용 된다. 
        
        - 따라서 cpu는 변수가 저장된 메모리 공간을 언제든 다시 참조할 수 있다

    - 공간 지역성

        - 접근한 메모리 공간 근처를 접근하려는 경향

        - 프로그램별로 뭉쳐서 메모리에 적재되고, 하나의 프로그램 내에서도 관련 기능끼리 모여서 적재된다

        - 가령 메모장, 인터넷 실행 시 프로그램별로 뭉쳐서 메모리에 적재되고, 메모장 내에서도 저장, 입력, 출력 기능별로 모여서 저장된다

        - 사용자가 메모장 실행 시 메모장이 모여있는 공간을 집중적으로 접근할 것이고, 메모장 입력 시 메모장 공간 내에서 입력이 모여있는 공간을 집중적으로 접근할 것이다  

#### Register

* cpu가 요청을 처리하는데 필요한 데이터를 임시 저장하는 cpu 내부에 존재하는 기억장치(휘발성 메모리)

* cpu가 요청을 처리하려면 메모리에 가서 데이터를 가져와 처리한 후 다시 메모리로 보내준다.

* 데이터를 처리하기 전, 후로 임시로 저장할 공간이 필요한데 그것이 레지스터이다.

* 컴퓨터에서 사용하는 32 / 64 비트는 메모리의 데이터를 한번에 들고 올 수 있는 레지스터의 비트 수이다.

* 64비트 프로그램은 레지스터로 한번에 64비트씩 넘기기 때문에 32비트를 들고 올 수 있는 32비트 운영체제에서는 실행하지 못한다.

* 32비트 프로그램은 64비트 운영체제에서 효율이 낮아지지만 실행은 가능하다.
