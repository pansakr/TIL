### 파일과 디렉터리

* 파일

    - 하드 디스크나 SSD 같은 보조기억장치에 저장된 관련된 정보의 집합

    - 이름과 실행하기 위한 정보, 관련 부가 정보가 있다

        - 관련 부가 정보를 속성 또는 메타데이터 라고 한다

        - 임의의 파일을 마우스 오른쪽 버튼 클릭 후 속성을 클릭하면 나타는 정보가 파일 속성이다

        - 속성에는 유형, 크기, 생성 날짜, 생성자, 소유자, 위치, 마지막 접근/수정 날짜 등이 있다

        - 그중 파일 유형은 운영체제가 인식하는 파일 종류를 나타내는 것으로 파일 유형이 다르면 실행 양상도 달라진다

        - 그래서 파일을 실행할 때 운영체제에게 파일 유형을 알려주어야 하는데 흔히 사용하는 방식이 확장자 이다

    - 파일을 다루는 모든 작업은 운영체제에 의해 이뤄지므로 응용 프로그램은 파일을 임의로 조작할 수 없으며 시스템 호출을 사용해 운영체제에게 요청해야 한다

    - 운영 체제는 파일 연산을 위한 시스템 호출을 제공한다

        - 파일 생성, 삭제, 열기, 닫기, 읽기, 쓰기 등

* 디렉터리

    - 파일을 일목요연하게 관리하기 위해 사용하며 윈도우 운영체제에서는 폴더 라고 부른다

    - 보통 여러 계층을 가진 트리 구조 디렉터리를 사용하며 최상위 디렉터리는 루트 디렉터리 라고 한다 

* 절대 경로와 상대 경로

    - 절대 경로

        - 루트 디렉터리에서 자시 자신까지 이르는 고유한 경로

        - 루트 디렉터리 하위에 home이 있고 그 하위에 a.txt 가 있다면 a.txt의 절대 경로는 /home/a.txt 이다

    - 상대 경로

        - 현재 디렉터리부터 시작하는 경로

        - 위의 절대경로 예시와 같은 상황에서 현재 디렉터리 경로가 /home 이라면 a.txt 파일의 상대 경로는 a.txt 이다

        - ..은 상위 디렉터리, .은 현재 디렉터리를 가리킨다

    - 운영체제는 디렉터리 연산을 위한 시스템 호출도 제공한다

        - 디렉터리 생성, 삭제, 열기, 닫기, 읽기 등

    
* 많은 운영체제는 디렉터리를 '포함된 정보가 조금 특별한 파일' 로 간주하며 파일과 디렉터리를 구분짓지 않는다

    - 파일이 내부에 해당 파일과 관련된 정보를 가지고 있다면 디렉터리는 내부에 해당 디렉터리에 담겨 있는 대상과 관련된 정보를 가지고 있다

    - 그리고 이 정보는 표의 형태로 구성되어 보조기억장치에 테이블 형태로 저장된다

    - 이 디렉터리 테이블에는 해당 디렉터리에 포함된 대상의 이름과 그 대상이 보조기억장치에 저장된 위치를 유추할 수 있는 정보가 담긴다

    <img src="https://github.com/user-attachments/assets/c8da1797-c733-43a7-98fa-521008a3cd04">

    - ..은 상위 디렉터리, .은 현재 디렉터리를 가리킨다

    - 디렉터리 엔트리(행)을 통해 저장된 위치를 알 수 있기 때문에 하위 디렉터리로 이동할 수 있고, 그 하위 디렉터리에 속한 파일들의 위치를 찾아 실행할 수 있다

### 파일 시스템

* 파일과 디렉터리를 보조기억장치에 저장하고 접근할 수 있게 하는 운영체제 내부 프로그램

* 하드 디스크나 SSD 새 제품을 사용하려면 파티셔닝과 포매팅을 거쳐야 한다

* 파티셔닝

    - 파티션을 나누는 작업으로 하나의 저장 장치를 여러개의 논리적 구역으로 나누는 것

    - 파티셔닝으로 나누어진 영역 하나하나를 '파티션' 이라고 한다

    - 이 작업으로 운영체제가 설치된 파티션과 개인 파일을 저장할 파티션을 분리한다

    - 백업 용도를 위한 파티션과 실제 실행할 응용 프로그램을 설치할 파티션으로 나누기도 한다 

* 포매팅

    - 파일 시스템을 설정해 어떤 방식으로 파일을 저장하고 관리할 것인지 결정하고 새로운 데이터를 쓸 준비를 하는 작업

    - 파티션마다 다른 파일 시스템을 설정할 수도 있다

* 파일 할당 방법

    - 운영체제는 파일과 디렉터리를 블록 단위로 읽고 쓴다

    - 하드 디스크의 가장 작은 단위는 섹터이지만 운영체제는 하나 이상의 섹터를 블록이라는 단위로 묶은 뒤 블록 단위로 파일과 디렉터리를 관리한다

    - 하나의 파일은 보조기억장치에 저장될 때 하나 이상의 블록에 걸쳐 저장된다

    - 기본적으로 크기가 작은 파일은 적은 수의 블록에 걸쳐서 저장되고, 큰 파일은 여러 블록에 걸쳐 저장된다

    - 파일을 보조기억장치에 할당하는 자세한 방법으로 연속 할당과 불연속 할당이 있으며 연속 할당 방식은 현재 거의 사용하지 않는다

    - 연속 할당

        - 파일이 저장장치 내에서 연속적인 공간을 차지하도록 블록을 할당하는 방식

        - 연속적으로 저장되기에 중간 몇몇 파일들이 삭제되었을때 해당 공간보다 큰 파일은 할당할 수 없다

        - 이것이 연속 할당에서의 외부 단편화이다

    - 불연속 할당

        - 연결 할당

            - 각 블록 일부에 다음 블록의 주소를 저장하여 각 블록이 다른 블록을 가리키는 형태로 할당하는 방식

            - 불연속 할당 방식이기에 파일이 여러 블록에 흩어져 저장되어도 된다

            - 그러나 블록이 다른 블록을 가리키고 있는 형태라서 반드시 첫 번째 블록부터 차레대로 읽어야 하기 때문에 성능 면에서 비효율적이다

            - 그리고 하나의 블록 안에 파일 데이터와 다음 블록 주소가 있다보니 하드웨어 고장이나 오류 발생으로 파일을 이루는 블록에 하나라도 문제가 생기면 그 블록 이후의 블록은 접근할 수 없다

            - 이 방법도 현재 거의 사용하지 않는다

        - 색인 할당

            - 파일의 모든 블록 주소를 색인 블록이라는 하나의 블록에 모아 관리하는 방법

            - 파일 A의 데이터가 여러 블록에 저장되어 있고, 그 위치가 해당 A 파일의 색인 블록에 저장된다

            - 색인 블록에 파일을 이루는 데이터 블록의 주소가 있으므로 특정 파일의 임의의 블록에 접근하기 쉽다

* FAT 파일 시스템

    - 연결 할당의 단점을 보완한 파일 시스템

        - 각 블록에 포함된 다음 블록의 주소들을 모아 테이블 형태로 관리한다

        - 이러한 테이블을 파일 할당 테이블(FAT - File Allocation Table) 이라고 한다

        - 첫번째 블록 주소만 알면 FAT를 확인해 파일의 데이터가 담긴 모든 블록에 접근 가능하다

        <img src="https://github.com/user-attachments/assets/b42fde2a-1192-4d8e-ab5e-ca014319a054">

    - USB, SD 카드 등의 저용량 저장 장치에 사용된다

    ```
    // 파일 시스템을 활용해 프로그램이나 데이터를 가져오는 과정

    1. 사용자가 특정 프로그램이나 파일을 클릭해서 운영체제에게 해당 파일이나 프로그램을 실행하기 위한 요청을 보낸다

    2. 운영체제는 파일 시스템을 통해 해당 파일이 저장된 위치를 확인한다. 파일 시스템은 하드 디스크에 저장된 데이터가 물리적으로 어디에 위치해 있는지에 대한 정보(파일의 블록 위치)를 가지고 있다

    3. 파일 시스템은 해당 파일이 저장된 위치를 확인한 후, 디스크 드라이브에서 해당 데이터를 읽어 메모리로 가져온다

    4. 읽어온 데이터를 메모리에 적재하며, 운영체제는 자주 사용될 것으로 예상되는 데이터를 캐시 메모리에 저장해 두어, 같은 데이터를 다시 요청할 때 하드 디스크에서 읽어오는 시간을 줄인다

    5. 메모리로 전송된 데이터는 CPU에 의해 처리되어 프로그램이 실행된다
    ```

* 유닉스 파일 시스템

    - 색인 할당 기반의 파일 시스템
